<!DOCTYPE html> <html lang=en dir=auto style><!--
 Page saved with SingleFile 
 url: https://www.snow-adventures.com/blog/glidequery-cheat-sheet/ 
 saved date: Thu Feb 20 2025 08:14:18 GMT-0400 (Bolivia Time)
--><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>GlideQuery Cheat Sheet | SNow adventures</title>
<meta name=keywords content=service-now,javascript,code,GlideQuery,GlideRecord,knowledge2020><meta name=description content="an attempt to document GlideQuery functions and methods"><meta name=author content=Sam><link rel=canonical href=https://www.snow-adventures.com/blog/glidequery-cheat-sheet/><style>:root{--gap:24px;--content-gap:20px;--nav-width:960px;--main-width:720px;--post-width:720px;--header-height:60px;--footer-height:80px;--radius:8px;--monospace:"Lucida Console",Monaco,"Consolas",monospace;--theme:rgb(255,255,255);--entry:rgb(255,255,255);--primary:rgb(30,30,30);--primary-dim:rgb(60,60,60);--secondary:rgb(108,108,108);--tertiary:rgb(158,158,158);--tertiary-bg:rgb(214,214,214);--content:rgb(31,31,31);--code-bg:rgb(245,245,245);--border:rgb(238,238,238);--link-background-color:#e8e3f7;--link-color:var(--primary);--link-hover-color:#573eaa;--link-underline-shadow:0 1px 0 var(--link-color);--link-hover-underline-color:#6549c0;--link-hover-underline-shadow:0 2px 0 var(--link-hover-underline-color);--link-transition:all 0.3s ease;--line-yellow:url(data:image/svg+xml;charset=utf-8,%3Csvg\ preserveAspectRatio=\'none\'\ width=\'120\'\ height=\'6\'\ viewBox=\'0\ 0\ 120\ 6\'\ xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath\ d=\'M119\ 0.8C60\ 4\ 50-0.5\ 1\ 1.5\'\ stroke=\'%23fc0\'\ stroke-width=\'3\'\ fill=\'none\'\ stroke-linecap=\'round\'/%3E%3C/svg%3E);--signature:var(--primary);--signature-bg:var(--secondary)}@media screen and (max-width:500px){:root{--header-height:52px}}*,::after,::before{box-sizing:border-box}html{-webkit-tap-highlight-color:transparent;overflow-y:scroll}a,button,body,h1,h2,h3,h4,h5{color:var(--primary)}body{font-family:-apple-system,BlinkMacSystemFont,Helvetica,helvetica neue,segoe ui,Roboto,Oxygen,Ubuntu,Cantarell,open sans,sans-serif;font-size:18px;line-height:1.6em;word-break:break-word;background:var(--theme)}article,footer,header,main,table{display:block}h1,h2,h3,h4,h5{line-height:1.2}h1,h2,h3,h4,h5,p{margin-top:0;margin-bottom:0}a{text-decoration:none}body{margin:0}table{width:100%;border-collapse:collapse;border-spacing:0;overflow-x:auto;word-break:keep-all}button{padding:0;font:inherit;background:0 0;border:0}button{cursor:pointer}img{display:block;max-width:100%}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:var(--tertiary-bg);border:5px solid var(--theme);border-radius:var(--radius)}::-webkit-scrollbar-thumb:hover{background:var(--secondary)}.footer,.top-link{font-size:12px;color:var(--secondary)}.footer{max-width:calc(var(--main-width) + var(--gap)*2);margin:auto;padding:calc((var(--footer-height) - var(--gap))/2) var(--gap);text-align:center;line-height:24px}.footer span{margin-inline-start:1px;margin-inline-end:1px}.footer span:last-child{white-space:nowrap}.footer a{font-weight:500;color:inherit;box-shadow:var(--link-underline-shadow)}.footer a:hover{color:var(--link-hover-color);box-shadow:var(--link-hover-underline-shadow)}.top-link:hover{color:var(--link-hover-color)}.top-link{position:fixed;bottom:60px;right:30px;z-index:99;background:var(--tertiary-bg);width:42px;height:42px;padding:12px;border-radius:64px;transition:visibility .5s,opacity .8s linear;line-height:1.5}.top-link,.top-link svg{filter:drop-shadow(0 0 0 var(--theme))}.top-link:focus,#theme-toggle:focus{outline:0}.nav{display:flex;flex-wrap:wrap;justify-content:space-between;max-width:calc(var(--nav-width) + var(--gap)*2);margin-inline-start:auto;margin-inline-end:auto;line-height:var(--header-height)}.nav ul{padding:0}.logo a{display:block}.logo,#menu{display:flex;margin:auto var(--gap)}.logo{flex-wrap:inherit}.logo a{font-size:24px;font-weight:700}#theme-toggle svg{height:18px}button#theme-toggle{font-size:26px;margin:auto 4px}body:not(.dark) #sun{display:none}#menu{list-style:none;word-break:keep-all;overflow-x:auto;white-space:nowrap}#menu li+li{margin-inline-start:var(--gap)}#menu a{font-size:16px;font-weight:500;color:var(--secondary);display:inline-block;line-height:1.5em}#menu a:hover{color:var(--primary)}.logo-switches{display:inline-flex;margin:auto 4px}.logo-switches{flex-wrap:inherit}.main{position:relative;min-height:calc(100vh - var(--header-height) - var(--footer-height));margin:auto;padding:var(--content-gap) var(--gap)0}@media screen and (max-width:500px){.main{padding-top:0}}@media screen and (max-width:500px){}.main.post{max-width:calc(var(--post-width) + var(--gap)*2)}code{direction:ltr}div.highlight,pre{position:relative}.meta-item{display:inline-block}.meta-item *{color:var(--secondary)}.meta-item:not(:last-of-type):after{content:"·";margin-inline-start:.5em;margin-inline-end:.5em}.meta-item svg{width:1em;height:1em;display:inline-block;vertical-align:-.15em}.meta-item a{transition:var(--link-transition)}.meta-item a:hover{color:var(--primary);box-shadow:0 1px 0 var(--secondary)}.meta-item .post-tags a:not(:last-of-type){margin-inline-end:.3em}.meta-item .post-tags a:not(:last-of-type):after{content:","}.meta-item .post-tags a:before{content:"#"}:root{--shadow-color:0deg 0% 0%;--shadow-elevation-low:0.6px 0.6px 1px hsl(var(--shadow-color)/0.1),0.9px 0.9px 1.4px -1.2px hsl(var(--shadow-color)/0.1),2.2px 2.2px 3.5px -2.5px hsl(var(--shadow-color)/0.1);--shadow-elevation-medium:0.6px 0.6px 1px hsl(var(--shadow-color)/0.11),1.8px 1.8px 2.9px -0.8px hsl(var(--shadow-color)/0.11),4.6px 4.6px 7.3px -1.7px hsl(var(--shadow-color)/0.11),11.1px 11.1px 17.7px -2.5px hsl(var(--shadow-color)/0.11);--twitter-color:#4a99e9}.post-header{margin:var(--content-gap)0 calc(var(--content-gap)*1.5)}.post-title{font-size:40px;margin-bottom:var(--content-gap)}.post-description{margin:var(--content-gap)0;color:var(--secondary);opacity:.8;padding-left:.5em;border-left:8px solid var(--signature)}.post-meta,.breadcrumbs{font-size:15px}.breadcrumbs{display:flex;flex-wrap:wrap}.breadcrumbs a{font-size:16px}.post-content{font-size:17px;color:var(--content)}.post-content h4,.post-content h5{margin:24px 0 16px}.post-content h3{margin:32px 0 24px}.post-content h2{margin:40px auto 32px;font-size:32px}.post-content h3{font-size:24px}.post-content h4{font-size:20px}.post-content h5{font-size:14px}.post-content a{font-weight:500;color:var(--primary);box-shadow:var(--link-underline-shadow);transition:var(--link-transition)}.post-content a:hover{color:var(--link-hover-color);box-shadow:var(--link-hover-underline-shadow)}.post-content p{margin-bottom:var(--content-gap)}.post-content table{margin-bottom:32px}.post-content table th,.post-content table:not(.highlighttable,.highlight table,.gist .highlight) td{min-width:80px;padding:12px 8px;line-height:1.5;border-bottom:1px solid var(--border)}.post-content table th{font-size:14px;text-align:start}.post-content .highlight:not(table){margin:var(--content-gap) auto;border-radius:var(--radius)}.post-content .highlight pre{margin:0}.post-content .chroma{border-radius:var(--radius)}.post-content code{background-color:var(--code-bg);margin:0 3px;padding:4px 5px;border-radius:3px;font-size:.95em;font-family:var(--monospace)}.post-content pre code{display:block;margin:auto 0;padding:15px;overflow-x:auto;border-radius:var(--radius);word-break:break-all}.post-content .chroma code{background-color:inherit;font-family:var(--monospace)}.post-content hr{margin:30px 0;height:2px;background:var(--tertiary-bg);border-top:0;border-bottom:0}.toc{margin:0 2px 40px;border:1px solid var(--border);background:var(--code-bg);border-radius:var(--radius);padding:.4em 0}.toc.side{font-size:.8em}@media screen and (min-width:1350px){.toc.side{position:fixed;top:118px;z-index:1;max-height:calc(100% - 150px);overflow:auto}.toc.side::-webkit-scrollbar-thumb{border:5px solid var(--code-bg)}.toc.side.right{right:15px;width:265px}}.toc details summary{cursor:pointer;margin-inline-start:15px}.toc .details{display:inline;font-weight:500}.toc .inner{padding:10px 15px 5px 35px}.toc ul{margin:0;padding:0}.toc li ul{margin-inline-start:20px}.toc li a{line-height:1.5em;padding:3px 5px;border-radius:5px;display:block}.toc li a.active{background-color:var(--link-background-color)}.toc li a:hover{text-decoration:underline}.toc summary:focus{outline:0}.post-footer{margin-top:calc(var(--content-gap)*1.5);padding-bottom:calc(var(--content-gap)*2)}.comments-separator{height:3px;background-color:var(--tertiary)}.post-content :not(table) ::-webkit-scrollbar-thumb{border:2px solid var(--code-bg);background:#717175}.post-content :not(table) ::-webkit-scrollbar-thumb:hover{background:#a3a3a5}.post-content table::-webkit-scrollbar-thumb{border-width:2px}.paginav{margin-top:var(--content-gap);display:flex;line-height:30px;border-radius:var(--radius)}.paginav svg{width:1em;height:1em;display:inline-block;vertical-align:-.125em}.paginav .title{letter-spacing:1px;text-transform:uppercase;font-size:small;color:var(--secondary)}.paginav .prev,.paginav .next{width:50%}.paginav a span{transition:var(--link-transition)}.paginav a:hover span:not(.title){box-shadow:0 1px}.paginav .next{margin-inline-start:auto;text-align:right}.chroma .k{color:#000;font-weight:700}.chroma .kc{color:#000;font-weight:700}.chroma .kd{color:#000;font-weight:700}.chroma .s1{color:#d14}.chroma .mi{color:#099}.chroma .o{color:#000;font-weight:700}.chroma .c1{color:#998;font-style:italic}.chroma{background-color:#f6f8fa}@media screen and (max-width:768px){:root{--gap:14px}.footer{padding:calc((var(--footer-height) - var(--gap) - 10px)/2) var(--gap)}}@media screen and (min-width:768px){::-webkit-scrollbar{width:19px;height:11px}}@media screen and (max-width:900px){}@media (prefers-reduced-motion){.top-link{transform:none}}@media screen and (max-width:500px){}@media screen and (max-width:500px){}@media screen and (max-width:960px){}@media screen and (max-width:500px){}@media screen and (max-width:500px){}</style><link rel=alternate hreflang=en href=https://www.snow-adventures.com/blog/glidequery-cheat-sheet/><meta name=twitter:card content=summary><meta name=twitter:title content="GlideQuery Cheat Sheet | SNow adventures"><meta name=twitter:description content="an attempt to document GlideQuery functions and methods"><meta property=og:title content="GlideQuery Cheat Sheet | SNow adventures"><meta property=og:description content="an attempt to document GlideQuery functions and methods"><meta property=og:type content=article><meta property=og:url content=https://www.snow-adventures.com/blog/glidequery-cheat-sheet/><meta property=og:image content=https://www.snow-adventures.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E><meta property=article:section content=blog><meta property=article:published_time content=2020-06-09T00:00:00+00:00><meta property=article:modified_time content=2020-06-09T00:00:00+00:00><meta property=og:site_name content="Sam's SNow adventures"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.snow-adventures.com/blog/"},{"@type":"ListItem","position":2,"name":"GlideQuery Cheat Sheet","item":"https://www.snow-adventures.com/blog/glidequery-cheat-sheet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"GlideQuery Cheat Sheet | SNow adventures","name":"GlideQuery Cheat Sheet","description":"an attempt to document GlideQuery functions and methods","keywords":["service-now","javascript","code","GlideQuery","GlideRecord","knowledge2020"],"wordCount":"1160","inLanguage":"en","datePublished":"2020-06-09T00:00:00Z","dateModified":"2020-06-09T00:00:00Z","author":{"@type":"Person","name":"Sam"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.snow-adventures.com/blog/glidequery-cheat-sheet/"},"publisher":{"@type":"Organization","name":"SNow adventures","logo":{"@type":"ImageObject","url":"https://www.snow-adventures.com/favicon.ico"}}}</script><meta name=referrer content=no-referrer><style>.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><body class="type-blog kind-page layout-" id=top><header class=header><nav class=nav><div class=logo><a href=https://www.snow-adventures.com/ accesskey=h title="SNow adventures (Alt + H)">SNow adventures</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id=moon width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentcolor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg><svg id=sun width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentcolor stroke-width=2 stroke-linecap=round stroke-linejoin=round><circle cx=12 cy=12 r=5></circle><line x1=12 y1=1 x2=12 y2=3></line><line x1=12 y1=21 x2=12 y2=23></line><line x1=4.22 y1=4.22 x2=5.64 y2=5.64></line><line x1=18.36 y1=18.36 x2=19.78 y2=19.78></line><line x1=1 y1=12 x2=3 y2=12></line><line x1=21 y1=12 x2=23 y2=12></line><line x1=4.22 y1=19.78 x2=5.64 y2=18.36></line><line x1=18.36 y1=5.64 x2=19.78 y2=4.22></line></svg></button></span></div><ul id=menu><li><a href=https://www.snow-adventures.com/posts/ title=Posts>Posts</a><li><a href=https://www.snow-adventures.com/categories/ title=Categories>Categories</a><li><a href=https://www.snow-adventures.com/tags/ title=Tags>Tags</a><li><a href=https://www.snow-adventures.com/search/ title="Search (Alt + /)" data-no-instant accesskey=/>Search</a><li><a href=https://www.snow-adventures.com/about/ title=About>About</a></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.snow-adventures.com/>Home</a>&nbsp;»&nbsp;<a href=https://www.snow-adventures.com/blog/>Posts</a></div><h1 class=post-title>GlideQuery Cheat Sheet</h1><div class=post-description>an attempt to document GlideQuery functions and methods</div><div class=post-meta><span class=meta-item><svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentcolor stroke-width=2 stroke-linecap=round stroke-linejoin=round class="feather feather-calendar" style=user-select:text><rect x=3 y=4 width=18 height=18 rx=2 ry=2 style=user-select:text></rect><line x1=16 y1=2 x2=16 y2=6 style=user-select:text></line><line x1=8 y1=2 x2=8 y2=6 style=user-select:text></line><line x1=3 y1=10 x2=21 y2=10 style=user-select:text></line></svg>
<span>2020-06-09</span></span><span class=meta-item>
<svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentcolor stroke-width=2 stroke-linecap=round stroke-linejoin=round class="feather feather-tag meta-icon" style=user-select:text><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style=user-select:text></path><line x1=7 y1=7 x2=7 y2=7 style=user-select:text></line></svg>
<span class=post-tags><a href=https://www.snow-adventures.com/tags/service-now/>Service-Now</a><a href=https://www.snow-adventures.com/tags/javascript/>Javascript</a><a href=https://www.snow-adventures.com/tags/code/>Code</a><a href=https://www.snow-adventures.com/tags/glidequery/>GlideQuery</a><a href=https://www.snow-adventures.com/tags/gliderecord/>GlideRecord</a><a href=https://www.snow-adventures.com/tags/knowledge2020/>Knowledge2020</a></span></span><span class=meta-item>
<svg width=24 height=24 viewBox="0 0 24 24" stroke=currentcolor stroke-width=2 fill=none stroke-linecap=round stroke-linejoin=round><path stroke=none d="M0 0h24v24H0z" fill=none></path><circle cx=12 cy=12 r=9></circle><polyline points="12 7 12 12 15 15"></polyline></svg>
<span>6 min</span></span></div></header><div class="toc side right"><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#invoking-glidequery aria-label="invoking GlideQuery">invoking <code>GlideQuery</code></a><li><a href=#cheat-sheet aria-label="Cheat sheet">Cheat sheet</a><ul><li><a href=#selections-insert-update aria-label="Selections, insert, update">Selections, insert, update</a><ul><li><a href=#get aria-label=get()>get()</a><ul><li><a href=#parameters aria-label=Parameters>Parameters</a><li><a href=#example aria-label=Example>Example</a></ul><li><a href=#getby aria-label=getBy()>getBy()</a><ul><li><a href=#parameters-1 aria-label=Parameters>Parameters</a><li><a href=#example-1 aria-label=Example>Example</a></ul><li><a href=#insert aria-label=insert()>insert()</a><ul><li><a href=#parameters-2 aria-label=Parameters>Parameters</a><li><a href=#example-2 aria-label=Example>Example</a></ul><li><a href=#insertorupdate aria-label=insertOrUpdate()>insertOrUpdate()</a><ul><li><a href=#parameters-3 aria-label=Parameters>Parameters</a><li><a href=#example-3 aria-label=Example>Example</a></ul><li><a href=#update aria-label=update()>update()</a><ul><li><a href=#parameters-4 aria-label=Parameters>Parameters</a><li><a href=#example-4 aria-label=Example>Example</a></ul><li><a href=#updatemultiple aria-label=updateMultiple()>updateMultiple()</a><ul><li><a href=#parameters-5 aria-label=Parameters>Parameters</a><li><a href=#example-5 aria-label=Example>Example</a></ul><li><a href=#select aria-label=select()>select()</a><ul><li><a href=#parameters-6 aria-label=Parameters>Parameters</a><li><a href=#example-6 aria-label=Example>Example</a></ul><li><a href=#selectone aria-label=selectOne()>selectOne()</a><ul><li><a href=#parameters-7 aria-label=Parameters class=active>Parameters</a><li><a href=#example-7 aria-label=Example>Example</a></ul><li><a href=#del aria-label=Del()>Del()</a><ul><li><a href=#example-8 aria-label=Example>Example</a></ul></ul><li><a href=#conditions aria-label=Conditions>Conditions</a><ul><li><a href=#where aria-label=where()>where()</a><ul><li><a href=#parameters-8 aria-label=Parameters>Parameters</a><li><a href=#example-9 aria-label=Example>Example</a></ul><li><a href=#wherenotnull aria-label=whereNotNull()>whereNotNull()</a><ul><li><a href=#parameters-9 aria-label=Parameters>Parameters</a><li><a href=#example-10 aria-label=Example>Example</a></ul><li><a href=#wherenull aria-label=whereNull()>whereNull()</a><ul><li><a href=#parameters-10 aria-label=Parameters>Parameters</a><li><a href=#example-11 aria-label=Example>Example</a></ul></ul><li><a href=#aggregations aria-label=Aggregations>Aggregations</a><ul><li><a href=#avg aria-label=avg()>avg()</a><ul><li><a href=#parameters-11 aria-label=Parameters>Parameters</a><li><a href=#example-12 aria-label=Example>Example</a></ul><li><a href=#max aria-label=max()>max()</a><ul><li><a href=#parameters-12 aria-label=Parameters>Parameters</a><li><a href=#example-13 aria-label=Example>Example</a></ul><li><a href=#min aria-label=min()>min()</a><ul><li><a href=#parameters-13 aria-label=Parameters>Parameters</a><li><a href=#example-14 aria-label=Example>Example</a></ul><li><a href=#sum aria-label=sum()>sum()</a><ul><li><a href=#parameters-14 aria-label=Parameters>Parameters</a><li><a href=#example-15 aria-label=Example>Example</a></ul><li><a href=#count aria-label=count()>count()</a><ul><li><a href=#example-16 aria-label=Example>Example</a></ul><li><a href=#groupby aria-label=groupBy()>groupBy()</a><ul><li><a href=#example-17 aria-label=Example>Example</a></ul><li><a href=#aggregate aria-label=aggregate()>aggregate()</a><ul><li><a href=#parameters-15 aria-label=Parameters>Parameters</a><li><a href=#example-18 aria-label=Example>Example</a></ul><li><a href=#having aria-label=having()>having()</a><ul><li><a href=#parameters-16 aria-label=Parameters>Parameters</a><li><a href=#example-19 aria-label=Example>Example</a></ul></ul><li><a href=#miscellanious aria-label=Miscellanious>Miscellanious</a><ul><li><a href=#disableautosysfields aria-label=disableAutoSysFields()>disableAutoSysFields()</a><ul><li><a href=#example-20 aria-label=Example>Example</a></ul><li><a href=#forceupdate aria-label=forceUpdate()>forceUpdate()</a><ul><li><a href=#example-21 aria-label=Example>Example</a></ul><li><a href=#orderby aria-label=orderBy()>orderBy()</a><ul><li><a href=#example-22 aria-label=Example>Example</a></ul><li><a href=#orderbydesc aria-label=orderByDesc()>orderByDesc()</a><ul><li><a href=#example-23 aria-label=Example>Example</a></ul><li><a href=#limit aria-label=limit()>limit()</a><ul><li><a href=#parameters-17 aria-label=Parameters>Parameters</a><li><a href=#example-24 aria-label=Example>Example</a></ul><li><a href=#withacls aria-label=withAcls()>withAcls()</a><ul><li><a href=#example-25 aria-label=Example>Example</a></ul></ul></ul></ul></div></details></div><div class=post-content><p>This is a draft Cheat Sheet for the <code>GlideQuery</code>. Please login <a href=https://www.snow-adventures.com/blog/overview-of-glidequery/ class="real-login">here</a> for a detailled introduction.<p>This cheat sheet was build with elements gathered from presentations and blog posts and also from reading the script include. It may not be accurate, might evolve and all comments and corrections are welcome !<h2 id=invoking-glidequery>invoking <code>GlideQuery</code><a hidden class="anchor sf-hidden" aria-hidden=true href=#invoking-glidequery>¶</a></h2><p>In a similar way that <code>GlideRecord</code>, the table name is passed as a parameter:<div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>myTable</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'table_name'</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><h2 id=cheat-sheet>Cheat sheet<a hidden class="anchor sf-hidden" aria-hidden=true href=#cheat-sheet>¶</a></h2><h3 id=selections-insert-update>Selections, insert, update<a hidden class="anchor sf-hidden" aria-hidden=true href=#selections-insert-update>¶</a></h3><h4 id=get>get()<a hidden class="anchor sf-hidden" aria-hidden=true href=#get>¶</a></h4><p>Returns a single record by querying primary key <code>key</code>.<h5 id=parameters>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>key<td>(sys_id)<tr><td>Array<td>selectedFields<td>Additional fields to return in result</table><h5 id=example>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>'5137153cc611227c000bbd1bd8cd2005'</span><span class=p>,</span> <span class=p>[</span><span class=s1>'first_name'</span><span class=p>,</span> <span class=s1>'last_name'</span><span class=p>])</span>
</span></span><span class=line><span class=cl>     <span class=p>.</span><span class=nx>orElse</span><span class=p>({</span> <span class=nx>first_name</span><span class=o>:</span> <span class=s1>'Default'</span><span class=p>,</span> <span class=nx>last_name</span><span class=o>:</span> <span class=s1>'User'</span> <span class=p>});</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=getby>getBy()<a hidden class="anchor sf-hidden" aria-hidden=true href=#getby>¶</a></h4><p>Returns a single record, using <code>keyValues</code> as a set of key-values to query by.
getBy assumes the ‘=’ operator for each key-value.<h5 id=parameters-1>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-1>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>Object<td>keyValues<td>Object where the keys are the name of the fields, and the values are the values.<tr><td>Array<td>selectedFields<td>Additional fields to return in result</table><h5 id=example-1>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-1>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>getBy</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>first_name</span><span class=o>:</span> <span class=s1>'Fred'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>last_name</span><span class=o>:</span> <span class=s1>'Luddy'</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=p>[</span><span class=s1>'first_name'</span><span class=p>,</span> <span class=s1>'last_name'</span><span class=p>,</span> <span class=s1>'city'</span><span class=p>,</span> <span class=s1>'active'</span><span class=p>])</span> <span class=c1>// select first_name, last_name, city, active
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>.</span><span class=nx>orElse</span><span class=p>({</span>
</span></span><span class=line><span class=cl>         <span class=nx>first_name</span><span class=o>:</span> <span class=s1>'Nobody'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>last_name</span><span class=o>:</span> <span class=s1>'Found'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>city</span><span class=o>:</span> <span class=s1>'Nowhere'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>active</span><span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=insert>insert()<a hidden class="anchor sf-hidden" aria-hidden=true href=#insert>¶</a></h4><p>Inserts a single record<h5 id=parameters-2>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-2>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>Object<td>keyValues<td>Object containing key-values to insert into table<tr><td>Array<td>selectedFields<td>Fields to return in result Optional</table><h5 id=example-2>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-2>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>insert</span><span class=p>({</span>
</span></span><span class=line><span class=cl>         <span class=nx>active</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=nx>name</span><span class=o>:</span> <span class=s1>'Sam Meylan'</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=nx>city</span><span class=o>:</span> <span class=s1>'Geneva'</span> 
</span></span><span class=line><span class=cl>    <span class=p>})</span> 
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>get</span><span class=p>();</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=insertorupdate>insertOrUpdate()<a hidden class="anchor sf-hidden" aria-hidden=true href=#insertorupdate>¶</a></h4><p>Updates an existing record (just like update), however instead of requiring
where calls, it uses the primary key(s) in the recordValues object passed
in. If the primary key(s) isn’t there, insertOrUpdate will insert a new
record instead. Returns an Optional of the newly created/updated record.
Often useful when you want to want to ensure a record exists and has the
correct values, as you don’t need to check for the record’s existence beforehand.<h5 id=parameters-3>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-3>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>Object<td>changes<td>Object containing key-values to update/insert into table<tr><td>Array<td>selectedFields<td>Fields to return in result Optional</table><h5 id=example-3>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-3>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// insert a new record
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>insertOrUpdate</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>first_name</span><span class=o>:</span> <span class=s1>'George'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>last_name</span><span class=o>:</span> <span class=s1>'Griffey'</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orElse</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// update existing record
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>insertOrUpdate</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>sys_id</span><span class=o>:</span> <span class=s1>'2d0efd6c73662300bb513198caf6a72e'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>first_name</span><span class=o>:</span> <span class=s1>'George'</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>last_name</span><span class=o>:</span> <span class=s1>'Griffey'</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orElse</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=update>update()<a hidden class="anchor sf-hidden" aria-hidden=true href=#update>¶</a></h4><p>Updates an existing record. Requires a where call, specifying all existing primary keys (usually sys_id). Returns an Optional of the newly-updated record.<h5 id=parameters-4>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-4>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>Object<td>changes<td>Object containing key-values to update/insert into table<tr><td>Array<td>selectedFields<td>Fields to return in result Optional</table><h5 id=example-4>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-4>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'sys_id'</span><span class=p>,</span> <span class=nx>userId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>update</span><span class=p>({</span> <span class=nx>city</span><span class=o>:</span> <span class=s1>'Los Angeles'</span> <span class=p>});</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=updatemultiple>updateMultiple()<a hidden class="anchor sf-hidden" aria-hidden=true href=#updatemultiple>¶</a></h4><p>Updates all records in the table (specified by preceding where clause with the values contained in the changes object. Returns # of records updated.<h5 id=parameters-5>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-5>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>Object<td>changes<td>Object containing key-values to update/insert into table</table><h5 id=example-5>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-5>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'active'</span><span class=p>,</span> <span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'last_name'</span><span class=p>,</span> <span class=s1>'Griffey'</span><span class=p>)</span><span class=o>&lt;</span><span class=nx>r</span><span class=o>&gt;</span>    <span class=p>.</span><span class=nx>updateMultiple</span><span class=p>({</span> <span class=nx>active</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=select>select()<a hidden class="anchor sf-hidden" aria-hidden=true href=#select>¶</a></h4><p>Specifies which fields to return and returns a Stream containing the results of the query. Note that records aren’t actually read from the database until a terminal Stream method is called (such as reduce() or toArray()). The Stream is intended for reading multiple records in a similar fashion to Java’s Stream class.<h5 id=parameters-6>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-6>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>…String<td>fields<td>Fields to select</table><h5 id=example-6>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-6>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>stream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>select</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>,</span> <span class=s1>'last_name'</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=selectone>selectOne()<a hidden class="anchor sf-hidden" aria-hidden=true href=#selectone>¶</a></h4><p>Similar to <code>select()</code>, however only returns an Optional which may contain a single record. This is more efficient than <code>select()</code> if you only need one record, or want to test if a record exists.<h5 id=parameters-7>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-7>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>…String<td>fields<td>Fields to select</table><h5 id=example-7>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-7>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'zip'</span><span class=p>,</span> <span class=s1>'12345'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>whereNotNull</span><span class=p>(</span><span class=s1>'last_name'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>selectOne</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>,</span> <span class=s1>'last_name'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>get</span><span class=p>();</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=del>Del()<a hidden class="anchor sf-hidden" aria-hidden=true href=#del>¶</a></h4><p>Deletes all records in the table specified by preceding where clauses<h5 id=example-8>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-8>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'active'</span><span class=p>,</span> <span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'last_name'</span><span class=p>,</span> <span class=s1>'Jeter'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>del</span><span class=p>();</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><h3 id=conditions>Conditions<a hidden class="anchor sf-hidden" aria-hidden=true href=#conditions>¶</a></h3><h4 id=where>where()<a hidden class="anchor sf-hidden" aria-hidden=true href=#where>¶</a></h4><p>Returns a new GlideQuery containing where clause<h5 id=parameters-8>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-8>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>Field related to the where clause</table><h5 id=example-9>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-9>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'active'</span><span class=p>,</span> <span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'last_login'</span><span class=p>,</span> <span class=s1>'&gt;'</span><span class=p>,</span> <span class=s1>'2016-04-15'</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=wherenotnull>whereNotNull()<a hidden class="anchor sf-hidden" aria-hidden=true href=#wherenotnull>¶</a></h4><p>Returns a new GlideQuery containing NOT NULL clause<h5 id=parameters-9>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-9>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>Field related to the clause</table><h5 id=example-10>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-10>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>whereNotNull</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>)</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=wherenull>whereNull()<a hidden class="anchor sf-hidden" aria-hidden=true href=#wherenull>¶</a></h4><p>Returns a new GlideQuery containing WHERE NULL clause<h5 id=parameters-10>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-10>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>Field related to the clause</table><h5 id=example-11>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-11>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>whereNull</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>)</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><h3 id=aggregations>Aggregations<a hidden class="anchor sf-hidden" aria-hidden=true href=#aggregations>¶</a></h3><h4 id=avg>avg()<a hidden class="anchor sf-hidden" aria-hidden=true href=#avg>¶</a></h4><p>Returns the aggregate average of a given numeric field<h5 id=parameters-11>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-11>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>Numeric field</table><h5 id=example-12>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-12>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>faults</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'cmdb_ci'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>avg</span><span class=p>(</span><span class=s1>'fault_count'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orElse</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=max>max()<a hidden class="anchor sf-hidden" aria-hidden=true href=#max>¶</a></h4><p>Returns the aggregate minimum of a given field<h5 id=parameters-12>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-12>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>field</table><h5 id=example-13>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-13>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>faults</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'cmdb_ci'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>max</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orElse</span><span class=p>(</span><span class=s1>''</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=min>min()<a hidden class="anchor sf-hidden" aria-hidden=true href=#min>¶</a></h4><p>Returns the aggregate maximum of a given field<h5 id=parameters-13>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-13>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>field</table><h5 id=example-14>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-14>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>faults</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'cmdb_ci'</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>	<span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=s1>'sys_mod_count'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orElse</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=sum>sum()<a hidden class="anchor sf-hidden" aria-hidden=true href=#sum>¶</a></h4><p>Returns the aggregate sum of a given numeric field<h5 id=parameters-14>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-14>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>field<td>Numeric field</table><h5 id=example-15>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-15>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>totalFaults</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'cmdb_ci'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>sum</span><span class=p>(</span><span class=s1>'fault_count'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orElse</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=count>count()<a hidden class="anchor sf-hidden" aria-hidden=true href=#count>¶</a></h4><p>Returns the row count of records matching the query<h5 id=example-16>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-16>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>userCount</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'active'</span><span class=p>,</span> <span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>count</span><span class=p>();</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=groupby>groupBy()<a hidden class="anchor sf-hidden" aria-hidden=true href=#groupby>¶</a></h4><p>Groups query results. Used with <code>aggregate()</code><h5 id=example-17>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-17>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'task'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>aggregate</span><span class=p>(</span><span class=s1>'count'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>groupBy</span><span class=p>(</span><span class=s1>'contact_type'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>select</span><span class=p>();</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=aggregate>aggregate()<a hidden class="anchor sf-hidden" aria-hidden=true href=#aggregate>¶</a></h4><p>Aggregates a field using an aggregate function. Used to buildqueries which aggregate against multiple fields and/or multipleaggregate functions. If you only need to aggregate against one field with one function, and you don’t need to use groupBy(), then use one of the terminal functions instead:
<code>avg()</code>
<code>min()</code>
<code>max()</code>
<code>count()</code><h5 id=parameters-15>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-15>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>aggregateType<td>Aggregate type (‘sum’, ‘avg’, ‘min’, ‘max’, or ‘count’)<tr><td>String<td>field<td>Field to aggregate</table><h5 id=example-18>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-18>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'task'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>aggregate</span><span class=p>(</span><span class=s1>'avg'</span><span class=p>,</span> <span class=s1>'reassignment_count'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>groupBy</span><span class=p>(</span><span class=s1>'contact_type'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>select</span><span class=p>();</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=having>having()<a hidden class="anchor sf-hidden" aria-hidden=true href=#having>¶</a></h4><p>Filters aggregate groups. Used with <code>aggregate()</code> and <code>groupBy</code>.<h5 id=parameters-16>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-16>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>String<td>aggregateType<td>Aggregate type (‘sum’, ‘avg’, ‘min’, ‘max’, or ‘count’)<tr><td>String<td>field<td>Field to aggregate<tr><td>String<td>operator<td>Only numeric operators allowed: ‘&gt;’, ‘&lt;’, ‘&gt;=’, ‘&lt;=’, ‘=’, and ‘!=’<tr><td>number<td>value<td></table><h5 id=example-19>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-19>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>*</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'task'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'description'</span><span class=p>,</span> <span class=nx>description</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>groupBy</span><span class=p>(</span><span class=s1>'priority'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>aggregate</span><span class=p>(</span><span class=s1>'sum'</span><span class=p>,</span> <span class=s1>'reassignment_count'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>having</span><span class=p>(</span><span class=s1>'sum'</span><span class=p>,</span> <span class=s1>'reassignment_count'</span><span class=p>,</span> <span class=s1>'&gt;'</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>select</span><span class=p>()</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><h3 id=miscellanious>Miscellanious<a hidden class="anchor sf-hidden" aria-hidden=true href=#miscellanious>¶</a></h3><h4 id=disableautosysfields>disableAutoSysFields()<a hidden class="anchor sf-hidden" aria-hidden=true href=#disableautosysfields>¶</a></h4><p>Returns a GlideQuery which does not update sys fields such as sys_created_on, sys_updated_on, and sys_mod_count. This is the equivalent of using autoSysFields(false) with GlideRecord.<h5 id=example-20>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-20>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'task'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>disableAutoSysFields</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>insert</span><span class=p>({</span> <span class=nx>description</span><span class=o>:</span> <span class=s1>'example'</span><span class=p>,</span> <span class=nx>priority</span><span class=o>:</span> <span class=mi>1</span> <span class=p>});</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=forceupdate>forceUpdate()<a hidden class="anchor sf-hidden" aria-hidden=true href=#forceupdate>¶</a></h4><p>Returns a GlideQuery which forces an update even when no changes are made. Useful when you want to force a business rule to execute.<h5 id=example-21>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-21>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'task'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>forceUpdate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>where</span><span class=p>(</span><span class=s1>'sys_id'</span><span class=p>,</span> <span class=nx>taskId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>update</span><span class=p>()</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=orderby>orderBy()<a hidden class="anchor sf-hidden" aria-hidden=true href=#orderby>¶</a></h4><p>Returns a GlideQuery which specifies that the records should be returned in ascending order by a given field.<h5 id=example-22>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-22>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>query</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'incident'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orderBy</span><span class=p>(</span><span class=s1>'number'</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=orderbydesc>orderByDesc()<a hidden class="anchor sf-hidden" aria-hidden=true href=#orderbydesc>¶</a></h4><p>Returns a GlideQuery which specifies that the records should be returned in descending order by a given field. Can be used with aggregate queries<h5 id=example-23>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-23>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>query</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'incident'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orderByDesc</span><span class=p>(</span><span class=s1>'number'</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'incident'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>aggregate</span><span class=p>(</span><span class=s1>'sum'</span><span class=p>,</span> <span class=s1>'child_incidents'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>groupBy</span><span class=p>(</span><span class=s1>'category'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orderByDesc</span><span class=p>(</span><span class=s1>'sum'</span><span class=p>,</span> <span class=s1>'child_incidents'</span><span class=p>)</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=limit>limit()<a hidden class="anchor sf-hidden" aria-hidden=true href=#limit>¶</a></h4><p>Returns a GlideQuery which limits the number of records returned.<h5 id=parameters-17>Parameters<a hidden class="anchor sf-hidden" aria-hidden=true href=#parameters-17>¶</a></h5><table><thead><tr><th>Type<th>Name<th>Description<tbody><tr><td>[number<td>limit max number of records to return<td></table><h5 id=example-24>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-24>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>incidents</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'incident'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>limit</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>select</span><span class=p>(</span><span class=s1>'priority'</span><span class=p>,</span> <span class=s1>'description'</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr><h4 id=withacls>withAcls()<a hidden class="anchor sf-hidden" aria-hidden=true href=#withacls>¶</a></h4><p>By default GlideQuery uses GlideRecord for database interactions. By calling withAcls() GlideQuery will use GlideRecordSecure, which honors ACLs.<h5 id=example-25>Example<a hidden class="anchor sf-hidden" aria-hidden=true href=#example-25>¶</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>users</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>GlideQuery</span><span class=p>(</span><span class=s1>'sys_user'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>withAcls</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>limit</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>orderByDesc</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>select</span><span class=p>(</span><span class=s1>'first_name'</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>toArray</span><span class=p>(</span><span class=mi>100</span><span class=p>);</span>
</span></span></code></pre><button class="copy-code sf-hidden">copy</button></div><hr></div><footer class=post-footer><nav class=paginav><a class=prev href=https://www.snow-adventures.com/blog/using-remote-tables-in-servicenow/><span class=title><svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentcolor stroke-width=2 stroke-linecap=round stroke-linejoin=round class="feather feather-arrow-left" style=user-select:text><line x1=19 y1=12 x2=5 y2=12 style=user-select:text></line><polyline points="12 19 5 12 12 5" style=user-select:text></polyline></svg>&nbsp;Prev Page</span><br><span>Using remote tables in ServiceNow</span>
</a><a class=next href=https://www.snow-adventures.com/blog/high-order-function-in-script-include-accessing-the-context-this/><span class=title>Next Page&nbsp;<svg width=24 height=24 viewBox="0 0 24 24" fill=none stroke=currentcolor stroke-width=2 stroke-linecap=round stroke-linejoin=round class="feather feather-arrow-right" style=user-select:text><line x1=5 y1=12 x2=19 y2=12 style=user-select:text></line><polyline points="12 5 19 12 12 19" style=user-select:text></polyline></svg></span><br><span>High order function in script include, accessing the context (this)</span></a></nav></footer><div class=comments-separator></div></article></main><footer class=footer><span>© Samuel Meylan - 2020</span><span style=display:inline-block;margin-left:1em>
<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/><img alt="Creative Common License BY-NC-SA" style=border-width:0 src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAABGdBTUEAANbY1E9YMgAAAJZQTFRFAAAARERE7u7ud3d3lJmTDg4OERERZmZmMzMzDQ4NW15bDQ0NfYJ9cnZx3d3dMTMxhoaGJygnZ2tnOz07ISEhOTs5QUJBGRkZQkJCJCUjICAgDQ0MxsrGs7iyh4eHLjAuQ0NDxcbFj5CPS0xLyMzIgICADxAPur+6ys7KmZmZqqqqu7u7VVVVIiIiiIiIzMzMq7Gq////+Wgu+gAAANlJREFUeNqtVNcShCAMDKBe77335lmS//+5E4fAjOPTyepLlp11TQDwD/IKbYgaU8gMJcIA8f2Ev2ANgzAjhpggvh4NDWdzssihi3i/NTPsZJSnIKSANCcxQnxfTX+NyOk1Y0qroKphH76UJqRUJD8xqQ7i61Kum5dYbypHsKpiOIBc6qkkbSqgQsTD3nzfythMP26tZAvUJxStSKoPqZ5L6H6Ya05oubqE2MsojqAlBbSHdD5xD13Cmh6yoNZwsfU85WB3JMZ603wf6rGMjd9y1fSkeIX/u+YHU7FSLRX36oMAAAAASUVORK5CYII=" class=__fx-devtools-hide-shortcut__></a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g style=visibility:visible;opacity:1><svg viewBox="0 0 12 6" fill=currentcolor><path d="M12 6H0l6-6z"></path></svg>
</a>